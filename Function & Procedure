--1 Function

CREATE OR REPLACE FUNCTION FACTORIAL(N IN NUMBER) RETURN NUMBER IS
    RESULT NUMBER := 1;
BEGIN
    FOR I IN 1..N LOOP
        RESULT := RESULT * I;
    END LOOP;
    RETURN RESULT;
END;
/
SET SERVEROUTPUT ON;
DECLARE
    NUM NUMBER;
    FACT NUMBER;
BEGIN
    NUM := &NUM;
    FACT := FACTORIAL(NUM);
    DBMS_OUTPUT.PUT_LINE('Factorial of ' || NUM || ' is ' || FACT);
END;
/


--2  Procedure

CREATE OR REPLACE PROCEDURE PR1 IS
BEGIN
    UPDATE STUDENT1
    SET MARKS=MARKS*1.05;
    COMMIT;
END;
/

BEGIN
    PR1;
 END;
 /
SELECT * FROM STUDENT1;

--3  

CREATE TABLE STUDENT2(
    ID NUMBER PRIMARY KEY,
    NAME VARCHAR2(20),
    M1 NUMBER,
    M2 NUMBER,
    M3 NUMBER,
    TOTAL NUMBER,
    GRADE VARCHAR2(10)
);

CREATE OR REPLACE FUNCTION FN1(TOT IN NUMBER) RETURN VARCHAR2 IS
SGRADE VARCHAR2(5);
BEGIN
    IF TOT>=240 THEN
    SGRADE:='A';
    ELSIF TOT>=180 THEN
    SGRADE:='B';
    ELSIF TOT>=120 THEN
    SGRADE:='C';
    ELSIF TOT>=60 THEN
    SGRADE:='D';
    ELSE
    SGRADE:='F';
    END IF;
    RETURN SGRADE;
END;
/

CREATE OR REPLACE PROCEDURE PR2(SID IN NUMBER) IS
TOTALM NUMBER;
NGRADE VARCHAR2(10);
BEGIN
    SELECT (M1+M2+M3) INTO TOTALM FROM STUDENT2;
    NGRADE:=FN1(TOTALM);
    UPDATE STUDENT2
    SET TOTAL=TOTALM, GRADE=NGRADE
    WHERE ID=SID;
COMMIT;
END;
/

DECLARE
V_ID NUMBER:=&ID;
V_NAME VARCHAR2(20):='&NAME';
V_M1 NUMBER:=&M1;
V_M2 NUMBER:=&M2;
V_M3 NUMBER:=&M3;
BEGIN
    INSERT INTO STUDENT2(ID,NAME,M1,M2,M3) VALUES(V_ID,V_NAME,V_M1,V_M2,V_M3);
    PR2(V_ID);
END;
/


SELECT * FROM STUDENT2;


