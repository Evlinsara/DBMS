--1
CREATE TABLE BANK_DETAILS(
    ACCT_NO NUMBER PRIMARY KEY,
    NAME VARCHAR2(20),
    BALANCE NUMBER,
    ADATE DATE
);

CREATE TABLE BANK_INTEREST(
    ACCTNO NUMBER PRIMARY KEY,
    INTEREST NUMBER
);

INSERT INTO BANK_DETAILS VALUES(1001,'Aby',3005,TO_DATE('10-10-2015','DD-MM-YYYY'));
INSERT INTO BANK_DETAILS VALUES(1002,'Alan',4000,TO_DATE('05-05-1995','DD-MM-YYYY'));
INSERT INTO BANK_DETAILS VALUES(1003,'Amal',5000,TO_DATE('16-03-1992','DD-MM-YYYY'));

SELECT * FROM BANK_DETAILS;

DECLARE 
    CURSOR BANK_CUR IS
        SELECT ACCT_NO, BALANCE FROM BANK_DETAILS;
    V_ACCT_NO BANK_DETAILS.ACCT_NO%TYPE;
    V_BALANCE BANK_DETAILS.BALANCE%TYPE;
    V_INTEREST NUMBER;
BEGIN
    OPEN BANK_CUR;
    LOOP
        FETCH BANK_CUR INTO V_ACCT_NO, V_BALANCE;
        EXIT WHEN BANK_CUR%NOTFOUND;
        V_INTEREST := 0.08 * V_BALANCE;
        INSERT INTO BANK_INTEREST(ACCTNO, INTEREST)
        VALUES (V_ACCT_NO, V_INTEREST);
    END LOOP;
    CLOSE BANK_CUR;
    COMMIT;
END;
/


--2
DECLARE 
    CURSOR C IS
        SELECT ID, M1, M2, M3 FROM STUDENT;

    V_TOTAL NUMBER;
    V_GRADE STUDENT.GRADE%TYPE;
BEGIN
    OPEN C;
    FOR REC IN C 
    LOOP
        V_TOTAL := REC.M1 + REC.M2 + REC.M3;

        IF V_TOTAL >= 240 THEN
            V_GRADE := 'A';
        ELSIF V_TOTAL >= 180 THEN
            V_GRADE := 'B';
        ELSIF V_TOTAL >= 120 THEN
            V_GRADE := 'C';
        ELSE
            V_GRADE := 'F';
        END IF;

        UPDATE STUDENT
        SET GRADE = V_GRADE
        WHERE ID = REC.ID;
    END LOOP;

    CLOSE C;
    COMMIT;
END;
/


--3

DECLARE
    CURSOR C IS
        SELECT ID, NAME, DT_JOINING FROM PEOPLE_LIST;
    V_YEARS NUMBER;
BEGIN
    FOR REC IN C LOOP
        V_YEARS := FLOOR(MONTHS_BETWEEN(SYSDATE, REC.DT_JOINING) / 12);
        IF V_YEARS > 10 THEN
            INSERT INTO EXP_LIST VALUES (REC.ID, REC.NAME, V_YEARS);
        END IF;
    END LOOP;
END;
/

--4

DECLARE
    CURSOR C IS
        SELECT ID, NAME, MONTHLY_SAL FROM EMPLOYEE_LIST;
    ANNUAL NUMBER;
    NEW_SAL NUMBER;
BEGIN
    FOR REC IN C LOOP
        ANNUAL := REC.MONTHLY_SAL * 12;
        
        IF ANNUAL < 60000 THEN
            NEW_SAL := REC.MONTHLY_SAL * 1.25;
        ELSIF ANNUAL BETWEEN 60000 AND 200000 THEN
            NEW_SAL := REC.MONTHLY_SAL * 1.20;
        ELSIF ANNUAL BETWEEN 200000 AND 500000 THEN
            NEW_SAL := REC.MONTHLY_SAL * 1.15;
        ELSE
            NEW_SAL := REC.MONTHLY_SAL * 1.10;
        END IF;

        UPDATE EMPLOYEE_LIST
        SET MONTHLY_SAL = NEW_SAL
        WHERE ID = REC.ID;  
    END LOOP;
END;
/

SELECT * FROM BANK_INTEREST;
